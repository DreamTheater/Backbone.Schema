/*!
 * Backbone.Schema v0.1.2
 * https://github.com/DreamTheater/Backbone.Schema
 *
 * Copyright (c) 2013 Dmytro Nemoga
 * Released under the MIT license
 */
(function(){"use strict";var t=Backbone.Model;Backbone.Model=t.extend({formatters:{string:function(t,e){return e},number:function(t,e){return Globalize.format(e,"n")},"boolean":function(t,e){return e},date:function(t,e){var n=new Date(e);return Globalize.format(n,"d")},text:function(t,e){return _.unescape(e)},currency:function(t,e){return Globalize.format(e,"c")},percent:function(t,e){return Globalize.format(e,"p")}},converters:{string:function(t,e){return e+""},number:function(t,e){var n=this.converters.string.call(this,t,e);return Globalize.parseFloat(n)},"boolean":function(t,e){return Boolean(e)},date:function(t,e){var n=Globalize.parseDate(e)||new Date(e);return n.getTime()},text:function(t,e){var n=this.converters.string.call(this,t,e);return n=_.unescape(n),_.escape(n)},currency:function(t,e){return this.converters.number.call(this,t,e)},percent:function(t,e){var n=this.converters.number.call(this,t,e);return _.isNumber(e)?n:n/100}},constructor:function(){t.apply(this,arguments)},defineProperty:function(t,e){var n=this.get(t),r=this._ensureDefaultValue(t),u=this.formatters[e],i=this.converters[e];return this.addGetter(t,function(t,e){return u.call(this,t,e)}),this.addSetter(t,function(t,e){var n={};return n[t]=_.isNull(e)||_.isUndefined(e)?r:i.call(this,t,e),n}),this.set(t,n,{silent:!0})},_ensureDefaultValue:function(t){var e,n=_.result(this,"defaults");return n&&(e=n[t]),_.isUndefined(e)&&(e=null),e}})})();